data.frame %>%
set_names(c("G11", "G22", "G12", "G21", "Gs")) %>%
mutate(Network = topoFiles %>% str_remove(".topo$"))
View(df)
directoryNav("CompiledData")
write_csv(df, paste0(net, "_GroupStrengths.csv"), quote = "none")
net <- "CellCollective"
write_csv(df, paste0(net, "_GroupStrengths.csv"), quote = "none")
ggplot(df, aes(x = Gs)) + geom_histogram(aes(y = ..count../sum(..count..)))
View(df)
df$nChar <- nchar(df$Network)
hist(df$nChar)
df1 <- filter(df, nChar >18)
ggplot(df1, aes(x = Gs)) + geom_histogram(aes(y = ..count../sum(..count..)))
View(df1)
source("D:/Github/Rpackages/Teams/R/setupScript.R")
source("D:/Github/Rpackages/Teams/R/setupScript.R")
packages
source("D:/Github/Rpackages/Teams/R/setupScript.R")
wd <- getwd()
setwd(topoFileFolder)
topoFiles <- list.files(".", pattern = ".topo")
topoDf <- lapply(topoFiles, read.delim(sep = " ")) %>% set_names(topoFiles)
topoDf <- lapply(topoFiles, read.delim,sep = " ") %>% set_names(topoFiles)
View(topoDf)
sapply(topoFiles, function(topoFile) {
setwd(gsCausation)
net <- topoFile %>% str_remove(".topo")
directoryNav(net)
write_delim(topoDf[[topoFile]], "wild.topo", delim = " ", quote = "none")
topo <- "wild.topo"
sapply(1:20, function(i) {
topo <<- findMax(topo)
})
})
source("D:/Github/Rpackages/Teams/R/utils.R")
getwd(0)
getwd()
sapply(topoFiles, function(topoFile) {
setwd(gsCausation)
net <- topoFile %>% str_remove(".topo")
directoryNav(net)
write_delim(topoDf[[topoFile]], "wild.topo", delim = " ", quote = "none")
topo <- "wild.topo"
sapply(1:20, function(i) {
topo <<- findMax(topo)
})
})
findMax <- function(topoDf, topoFile)
{
topoOriginal <- list.files(".", ".topo")
net <- topoFile %>% str_remove(".topo")
topoDf <- read.delim(topoFile, sep = "")
GWT <- groupStrength(topoFile)[5]
GsChange <- sapply(1:nrow(topoDf), function(x){
df <- topoDf[-x, ]
topo <- paste0(net, "_", x, ".topo")
write_delim(df, topo, delim = " ", quote = "none")
G <- groupStrength(topo)[5]
GWT-G
})
n <- which.max(GsChange)
topoFile <- paste0(net, "_", n,".topo")
topoOriginal <- c(topoOriginal, topoFile)
topoFiles <- list.files(".", ".topo")
topoFiles <- topoFiles[-which(topoFiles %in% topoOriginal)]
sapply(topoFiles, file.remove)
return(topoFile)
}
getwd()
setwd("..")
sapply(topoFiles, function(topoFile) {
setwd(gsCausation)
net <- topoFile %>% str_remove(".topo")
directoryNav(net)
write_delim(topoDf[[topoFile]], "wild.topo", delim = " ", quote = "none")
topo <- "wild.topo"
sapply(1:20, function(i) {
topo <<- findMax(topo)
})
})
findMax <- function(topoFile)
{
topoOriginal <- list.files(".", ".topo")
net <- topoFile %>% str_remove(".topo")
topoDf <- read.delim(topoFile, sep = "")
GWT <- groupStrength(topoFile)[5]
GsChange <- sapply(1:nrow(topoDf), function(x){
df <- topoDf[-x, ]
topo <- paste0(net, "_", x, ".topo")
write_delim(df, topo, delim = " ", quote = "none")
G <- groupStrength(topo)[5]
GWT-G
})
n <- which.max(GsChange)
topoFile <- paste0(net, "_", n,".topo")
topoOriginal <- c(topoOriginal, topoFile)
topoFiles <- list.files(".", ".topo")
topoFiles <- topoFiles[-which(topoFiles %in% topoOriginal)]
sapply(topoFiles, file.remove)
return(topoFile)
}
sapply(topoFiles, function(topoFile) {
setwd(gsCausation)
net <- topoFile %>% str_remove(".topo")
directoryNav(net)
write_delim(topoDf[[topoFile]], "wild.topo", delim = " ", quote = "none")
topo <- "wild.topo"
sapply(1:20, function(i) {
topo <<- findMax(topo)
})
})
source("D:/Github/Rpackages/Teams/R/influenceAndGs.R")
findMax <- function(topoFile)
{
topoOriginal <- list.files(".", ".topo")
net <- topoFile %>% str_remove(".topo")
topoDf <- read.delim(topoFile, sep = "")
GWT <- groupStrength(topoFile)[5]
GsChange <- sapply(1:nrow(topoDf), function(x){
df <- topoDf[-x, ]
topo <- paste0(net, "_", x, ".topo")
write_delim(df, topo, delim = " ", quote = "none")
G <- GroupStrength(topo)[5]
GWT-G
})
n <- which.max(GsChange)
topoFile <- paste0(net, "_", n,".topo")
topoOriginal <- c(topoOriginal, topoFile)
topoFiles <- list.files(".", ".topo")
topoFiles <- topoFiles[-which(topoFiles %in% topoOriginal)]
sapply(topoFiles, file.remove)
return(topoFile)
}
sapply(topoFiles, function(topoFile) {
setwd(gsCausation)
net <- topoFile %>% str_remove(".topo")
directoryNav(net)
write_delim(topoDf[[topoFile]], "wild.topo", delim = " ", quote = "none")
topo <- "wild.topo"
sapply(1:20, function(i) {
topo <<- findMax(topo)
})
})
findMax <- function(topoFile)
{
topoOriginal <- list.files(".", ".topo")
net <- topoFile %>% str_remove(".topo")
topoDf <- read.delim(topoFile, sep = "")
GWT <- GroupStrength(topoFile)[5]
GsChange <- sapply(1:nrow(topoDf), function(x){
df <- topoDf[-x, ]
topo <- paste0(net, "_", x, ".topo")
write_delim(df, topo, delim = " ", quote = "none")
G <- GroupStrength(topo)[5]
GWT-G
})
n <- which.max(GsChange)
topoFile <- paste0(net, "_", n,".topo")
topoOriginal <- c(topoOriginal, topoFile)
topoFiles <- list.files(".", ".topo")
topoFiles <- topoFiles[-which(topoFiles %in% topoOriginal)]
sapply(topoFiles, file.remove)
return(topoFile)
}
sapply(topoFiles, function(topoFile) {
setwd(gsCausation)
net <- topoFile %>% str_remove(".topo")
directoryNav(net)
write_delim(topoDf[[topoFile]], "wild.topo", delim = " ", quote = "none")
topo <- "wild.topo"
sapply(1:20, function(i) {
topo <<- findMax(topo)
})
})
source("D:/Github/Rpackages/Teams/R/influenceAndGs.R")
sapply(topoFiles, function(topoFile) {
setwd(gsCausation)
net <- topoFile %>% str_remove(".topo")
directoryNav(net)
write_delim(topoDf[[topoFile]], "wild.topo", delim = " ", quote = "none")
topo <- "wild.topo"
sapply(1:20, function(i) {
topo <<- findMax(topo)
})
})
topoFile <- "wild_7_15_3_11.topo"
ls <- TopoToIntMat(topoFile)
intmat <- ls[[1]]
nodes <- ls[[2]]
net <- topoFile %>% str_remove(".topo$")
inflMat <- InfluenceMatrix(net, intmat, nodes, pathLength)
pathLength = 10
inflMat <- InfluenceMatrix(net, intmat, nodes, pathLength)
nodes <- rownames(inflMat)
getwd()
View(intmat)
lmax = 10
intmax <- intmat
intmax[which(intmax == -1)] <- 1
res <- 0
for (l in 1:lmax) {
intM <- ComputePowerMatrix(intmat, l)
maxM <- ComputePowerMatrix(intmax, l)
r1 <- intM / maxM
r1[is.nan(r1)] <- intM[is.nan(r1)]
res <- res + r1
}
res <- res / lmax
View(res)
nodes <- ls[[2]]
nodes <- nodes
influence_mat <- res
View(influence_mat)
colnames(influence_mat) <- rownames(influence_mat) <- nodes
signal <- which(apply(intmat, 2, function(x) {
all(x == 0)
}))
output <- which(apply(intmat, 1, function(x) {
all(x == 0)
}))
secondary_signal <- which(apply(intmat, 2, function(x) {
if (length(signal) != 0) {
all(x[-signal] == 0)
} else {
F
}
}))
secondary_output <- which(apply(intmat, 1, function(x) {
if (length(output) != 0) {
all(x[-output] == 0)
} else {
F
}
}))
nonEssentials <- c(signal, output, secondary_signal, secondary_output)
nonEssentials
nonEssentials <- c(signal, output, secondary_signal, secondary_output) %>% unique
source("D:/Github/Rpackages/Teams/R/influenceAndGs.R")
findMax <- function(topoFile)
{
topoOriginal <- list.files(".", ".topo")
net <- topoFile %>% str_remove(".topo")
topoDf <- read.delim(topoFile, sep = "")
GWT <- GroupStrength(topoFile)[5]
if (is.null(GWT)) # happens when all nodes are signal or output
return("Stop")
GsChange <- sapply(1:nrow(topoDf), function(x){
df <- topoDf[-x, ]
topo <- paste0(net, "_", x, ".topo")
write_delim(df, topo, delim = " ", quote = "none")
G <- GroupStrength(topo)[5]
GWT-G
})
n <- which.max(GsChange)
topoFile <- paste0(net, "_", n,".topo")
topoOriginal <- c(topoOriginal, topoFile)
topoFiles <- list.files(".", ".topo")
topoFiles <- topoFiles[-which(topoFiles %in% topoOriginal)]
sapply(topoFiles, file.remove)
return(topoFile)
}
getwd()
setwd(topoFileFolder)
topoFiles <- list.files(".", pattern = ".topo")
topoDf <- lapply(topoFiles, read.delim,sep = " ") %>% set_names(topoFiles)
sapply(topoFiles, function(topoFile) {
setwd(gsCausation)
net <- topoFile %>% str_remove(".topo")
directoryNav(net)
write_delim(topoDf[[topoFile]], "wild.topo", delim = " ", quote = "none")
topo <- "wild.topo"
sapply(1:20, function(i) {
if (topo == "Stop")
return()
topo <<- findMax(topo)
})
})
topoFiles
sapply(topoFiles, function(topoFile) {
setwd(gsCausation)
net <- topoFile %>% str_remove(".topo")
directoryNav(net)
write_delim(topoDf[[topoFile]], "wild.topo", delim = " ", quote = "none")
topo <- "wild.topo"
sapply(1:20, function(i) {
browser()
if (topo == "Stop")
return()
topo <<- findMax(topo)
})
})
topo
findMax(topo)
topo
topoFile <- topo
topoOriginal <- list.files(".", ".topo")
net <- topoFile %>% str_remove(".topo")
topoOriginal <- list.files(".", ".topo")
net <- topoFile %>% str_remove(".topo")
topoDf <- read.delim(topoFile, sep = "")
GWT <- GroupStrength(topoFile)[5]
findMax <- function(topoFile)
{
topoOriginal <- list.files(".", ".topo")
net <- topoFile %>% str_remove(".topo")
topoDf <- read.delim(topoFile, sep = "")
GWT <- GroupStrength(topoFile)[5]
if (is.null(GWT) || GWT == 0) # happens when all nodes are signal or output
return("Stop")
GsChange <- sapply(1:nrow(topoDf), function(x){
df <- topoDf[-x, ]
topo <- paste0(net, "_", x, ".topo")
write_delim(df, topo, delim = " ", quote = "none")
G <- GroupStrength(topo)[5]
GWT-G
})
n <- which.max(GsChange)
topoFile <- paste0(net, "_", n,".topo")
topoOriginal <- c(topoOriginal, topoFile)
topoFiles <- list.files(".", ".topo")
topoFiles <- topoFiles[-which(topoFiles %in% topoOriginal)]
sapply(topoFiles, file.remove)
return(topoFile)
}
setwd(topoFileFolder)
topoFiles <- list.files(".", pattern = ".topo")
topoDf <- lapply(topoFiles, read.delim,sep = " ") %>% set_names(topoFiles)
sapply(topoFiles, function(topoFile) {
setwd(gsCausation)
net <- topoFile %>% str_remove(".topo")
directoryNav(net)
write_delim(topoDf[[topoFile]], "wild.topo", delim = " ", quote = "none")
topo <- "wild.topo"
sapply(1:20, function(i) {
# browser()
if (topo == "Stop")
return()
topo <<- findMax(topo)
})
})
Causation <- function() {
wd <- getwd()
setwd(topoFileFolder)
topoFiles <- list.files(".", pattern = ".topo")
topoDf <- lapply(topoFiles, read.delim,sep = " ") %>% set_names(topoFiles)
sapply(topoFiles, function(topoFile) {
setwd(gsCausation)
net <- topoFile %>% str_remove(".topo")
directoryNav(net)
write_delim(topoDf[[topoFile]], "wild.topo", delim = " ", quote = "none")
topo <- "wild.topo"
sapply(1:20, function(i) {
# browser()
if (topo == "Stop")
return()
topo <<- findMax(topo)
})
setwd("Influence")
filz <- list.files(".")
sapply(filz, file.remove)
setwd("..")
})
}
Causation()
Causation <- function() {
wd <- getwd()
setwd(topoFileFolder)
topoFiles <- list.files(".", pattern = ".topo")
topoDf <- lapply(topoFiles, read.delim,sep = " ") %>% set_names(topoFiles)
sapply(topoFiles, function(topoFile) {
setwd(gsCausation)
net <- topoFile %>% str_remove(".topo")
directoryNav(net)
write_delim(topoDf[[topoFile]], "wild.topo", delim = " ", quote = "none")
topo <- "wild.topo"
sapply(1:20, function(i) {
# browser()
if (topo == "Stop")
return()
topo <<- findMax(topo)
})
setwd("Influence")
filz <- list.files(".")
sapply(filz, file.remove)
setwd("..")
GroupStrengthAll(topoFile %>% str_remove(".topo$"))
})
}
Causation()
Causation <- function() {
wd <- getwd()
setwd(topoFileFolder)
topoFiles <- list.files(".", pattern = ".topo")
topoDf <- lapply(topoFiles, read.delim,sep = " ") %>% set_names(topoFiles)
sapply(topoFiles, function(topoFile) {
setwd(gsCausation)
net <- topoFile %>% str_remove(".topo")
directoryNav(net)
write_delim(topoDf[[topoFile]], "wild.topo", delim = " ", quote = "none")
topo <- "wild.topo"
sapply(1:20, function(i) {
# browser()
if (topo == "Stop")
return()
topo <<- findMax(topo)
})
setwd("Influence")
filz <- list.files(".")
sapply(filz, file.remove)
setwd("..")
GroupStrengthAll(topoFile %>% str_remove(".topo$"))
})
}
Causation()
source("D:/Github/Rpackages/Teams/R/utils.R")
source("D:/Github/Rpackages/Teams/R/utils.R")
?read_csv
x <- sample(c(0,1),1000, replace = F)
x <- sample(c(0,1),1000, replace = T)
?min
?cor.test
getOption("na.action")
source("D:/Github/Rpackages/Teams/R/setupScript.R")
devtools::load_all()
test <- function(x = NULL) {
if (is.null(x))
x <- runif(10)
x <<- mean(x)
print(x)
}
test()
x
devtools::load_all()
devtools::load_all()
devtools::load_all()
CausationNetworks(nMax = 20)
CausationNetworks <- function(nMax = 20) {
wd <- getwd()
setwd(topoFileFolder)
topoFiles <- list.files(".", pattern = ".topo")
topoDf <- lapply(topoFiles, read.delim,sep = " ") %>% set_names(topoFiles)
sapply(topoFiles, function(topoFile) {
setwd(gsCausation)
net <- topoFile %>% str_remove(".topo")
DirectoryNav(net)
RemoveAllFiles()
write_delim(topoDf[[topoFile]], "wild.topo", delim = " ", quote = "none")
topo <- "wild.topo"
sapply(1:nMax, function(i) {
# browser()
if (topo == "Stop")
return()
topo <<- findMax(topo)
})
setwd("Influence")
RemoveAllFiles()
setwd("..")
})
}
CausationNetworks(nMax = 20)
CausationNetworks
CausationNetworks(nMax = 20)
devtools::load_all()
devtools::load_all()
devtools::load_all()
devtools::load_all()
devtools::load_all()
CausationNetworks(nMax = 20)
CausationNetworks
setwd("D:/Github/Rpackages/Teams")
devtools::load_all()
CausationNetworks(nMax = 20)
setwd("D:/Github/Rpackages/Teams")
devtools::load_all()
CausationNetworks(nMax = 20)
debug(InfluenceMatrix)
CausationNetworks(nMax = 20)
View(influence_reduced)
CausationNetworks(nMax = 20)
influence_reduced[, 1]
rownames(influence_reduced) <- influence_reduced[, 1]
rn <- influence_reduced[, 1]
influence_reduced <- influence_reduced[, -1] %>% as.matrix
rownames(influence_reduced) <- rn
View(influence_reduced)
View(rn)
rn <- influence_reduced[, 1] %>% unlist
influence_reduced <- influence_reduced[, -1] %>% as.matrix
rownames(influence_reduced) <- rn
setwd("D:/Github/Rpackages/Teams")
devtools::load_all()
CausationNetworks(nMax = 20)
getwd()
topoFile <- "test.topo"
logDf <- logDf %>% mutate(Influence = ifelse(Files == topoFile, "Fail", Influence))
debug(GroupStrength)
logDf <- logDf %>% mutate(Influence = ifelse(Files == topoFile, "Fail", Influence))
CausationNetworks(nMax = 20)
setwd("D:/Github/Rpackages/Teams")
devtools::load_all()
CausationNetworks(nMax = 20)
SimulateBoolean(cause = T)
getwd()
topoFiles <- list.files(".", ".topo$")
size <- floor(length(topoFiles)/numThreads)
numThreads
numThreads <- 3
SimulateBoolean(cause = T)
setwd("D:/Github/Rpackages/Teams")
devtools::load_all()
SimulateBoolean(cause = T)
